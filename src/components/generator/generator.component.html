
<div class="flex flex-col lg:flex-row gap-8">
  
  <!-- Left Sidebar: Controls -->
  <aside class="w-full lg:w-80 flex-shrink-0">
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 sticky top-24">
      <h2 class="text-lg font-semibold text-slate-900 mb-6">Configuration</h2>
      
      <div class="space-y-6">
        <!-- Country Selection (Combobox) -->
        <div class="relative">
          <label class="block text-sm font-medium text-slate-700 mb-2">Target Country</label>
          <div class="relative">
            <input 
              type="text"
              [(ngModel)]="countrySearchQuery"
              (focus)="onSearchFocus()"
              (blur)="onSearchBlur()"
              class="block w-full rounded-lg border-slate-300 py-2.5 pl-3 pr-10 text-slate-900 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 sm:text-sm border bg-slate-50 shadow-sm"
              placeholder="Type to search..."
            >
            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
              <svg class="h-4 w-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </div>
            
            <!-- Dropdown List -->
            @if (isCountryDropdownOpen()) {
              <ul class="absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm custom-scrollbar">
                @for (country of filteredCountries(); track country.code) {
                  <li 
                    class="relative cursor-default select-none py-2 pl-3 pr-9 text-slate-900 hover:bg-indigo-50 cursor-pointer"
                    (mousedown)="selectCountry(country)"
                  >
                    <span class="block truncate" [class.font-semibold]="selectedCountryCode() === country.code">
                      {{ country.name }} <span class="text-slate-400 text-xs ml-1 font-mono">({{ country.code }})</span>
                    </span>
                    @if (selectedCountryCode() === country.code) {
                      <span class="absolute inset-y-0 right-0 flex items-center pr-4 text-indigo-600">
                        <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                      </span>
                    }
                  </li>
                }
                @if (filteredCountries().length === 0) {
                  <li class="relative cursor-default select-none py-2 pl-3 pr-9 text-slate-500 italic">No matches found</li>
                }
              </ul>
            }
          </div>
        </div>

        <!-- Bank Selection (Dynamic Multi-Select) -->
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">Available Banks</label>
          <div class="border border-slate-300 rounded-lg bg-slate-50 max-h-48 overflow-y-auto p-2 space-y-2 custom-scrollbar">
            @for (bank of availableBanks(); track bank.swift) {
              <label class="flex items-start space-x-3 cursor-pointer hover:bg-slate-100 p-1.5 rounded transition-colors select-none">
                <input 
                  type="checkbox" 
                  [value]="bank.swift"
                  (change)="toggleBank(bank.swift, $event)"
                  [checked]="isBankSelected(bank.swift)"
                  class="mt-1 h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer"
                >
                <span class="text-sm text-slate-700 flex flex-col">
                  <span class="font-medium text-slate-900">{{bank.name}}</span> 
                  <span class="text-slate-500 text-xs font-mono">{{bank.swift}}</span>
                </span>
              </label>
            }
            @if (availableBanks().length === 0) {
              <p class="text-xs text-slate-400 italic p-2 text-center">No preset banks for this country.</p>
            }
          </div>
          <p class="text-xs text-slate-400 mt-1">Select specific banks or leave empty for random.</p>
        </div>

        <!-- Custom Bank Override -->
        <div class="bg-indigo-50 p-3 rounded-lg border border-indigo-100">
          <label class="block text-xs font-bold text-indigo-900 uppercase tracking-wide mb-2">Add Custom Bank</label>
          <div class="space-y-3">
            <div>
              <input 
                type="text" 
                [(ngModel)]="customBankName"
                placeholder="Bank Name (e.g. MyBank)"
                class="block w-full rounded border-slate-300 py-1.5 text-xs text-slate-900 focus:border-indigo-500 focus:ring-indigo-500 placeholder:text-slate-400"
              >
            </div>
            <div>
              <input 
                type="text" 
                [(ngModel)]="customBankSwift"
                placeholder="SWIFT / BIC Code (Required)"
                class="block w-full rounded border-slate-300 py-1.5 text-xs font-mono text-slate-900 focus:border-indigo-500 focus:ring-indigo-500 placeholder:text-slate-400"
              >
            </div>
            <p class="text-[10px] text-slate-500">
              Check valid codes at <a href="https://www.swift.com/standards/data-standards/bic-supervisory-tool" target="_blank" rel="noopener noreferrer" class="text-indigo-600 underline hover:text-indigo-800">swift.com</a>
            </p>
          </div>
        </div>

        <!-- Count Selection -->
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-2">
            Records: <span class="text-indigo-600 font-bold">{{ recordCount() }}</span>
          </label>
          <input 
            type="range" 
            min="1" 
            max="20" 
            [ngModel]="recordCount()"
            (ngModelChange)="recordCount.set($event)"
            class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"
          >
          <div class="flex justify-between text-xs text-slate-400 mt-1">
            <span>1</span>
            <span>20</span>
          </div>
        </div>

        <!-- Generate Button -->
        <button 
          (click)="generate()"
          class="w-full flex items-center justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
          </svg>
          Generate Data
        </button>

      </div>
    </div>
  </aside>

  <!-- Right Content: Results -->
  <div class="flex-1 min-w-0">
    @if (generatedData().length > 0) {
      <div class="bg-white shadow-sm rounded-xl border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 border-b border-slate-200 bg-slate-50 flex flex-col sm:flex-row justify-between items-center gap-4">
          <div class="flex items-center gap-2">
            <h3 class="text-lg font-semibold text-slate-900">Generated Records</h3>
            <span class="inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800">
              {{ generatedData().length }} results
            </span>
          </div>
          
          <!-- Actions -->
          <div class="flex items-center gap-2">
            <button 
              (click)="exportCSV()"
              class="inline-flex items-center px-3 py-1.5 border border-slate-300 shadow-sm text-xs font-medium rounded-md text-slate-700 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              CSV
            </button>
            <button 
              (click)="exportJSON()"
              class="inline-flex items-center px-3 py-1.5 border border-slate-300 shadow-sm text-xs font-medium rounded-md text-slate-700 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
            >
              JSON
            </button>
          </div>
        </div>
        
        <div class="overflow-x-auto custom-scrollbar">
          <table class="min-w-full divide-y divide-slate-200 border-separate" style="border-spacing: 0">
            <thead class="bg-slate-50">
              <tr>
                <!-- NAME -->
                <th scope="col" (click)="toggleColumn('fullName')" class="group sticky left-0 z-10 bg-slate-50 px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Name</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('fullName')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- BANK -->
                <th scope="col" (click)="toggleColumn('bankName')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Bank</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('bankName')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- PRIMARY ID -->
                <th scope="col" (click)="toggleColumn('primaryIdentifier')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Primary ID</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('primaryIdentifier')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- SECONDARY ID -->
                <th scope="col" (click)="toggleColumn('secondaryIdentifier')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Secondary ID</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('secondaryIdentifier')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- CCY -->
                <th scope="col" (click)="toggleColumn('currency')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Ccy</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('currency')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- STREET 1 -->
                <th scope="col" (click)="toggleColumn('street1')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Street 1</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('street1')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- STREET 2 -->
                <th scope="col" (click)="toggleColumn('street2')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Street 2</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('street2')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- CITY -->
                <th scope="col" (click)="toggleColumn('city')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">City</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('city')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- REGION -->
                <th scope="col" (click)="toggleColumn('region')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Region</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('region')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- POSTAL CODE -->
                <th scope="col" (click)="toggleColumn('postalCode')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Postal</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('postalCode')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- COUNTRY CODE -->
                <th scope="col" (click)="toggleColumn('countryCode')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                   <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Country Code</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('countryCode')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>

                <!-- COUNTRY NAME -->
                <th scope="col" (click)="toggleColumn('country')" class="group px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors select-none">
                  <div class="flex items-center justify-between gap-2 h-4">
                    <span class="truncate">Country Name</span>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-400 group-hover:text-indigo-600 transition-all" [class.rotate-180]="isCollapsed('country')" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-slate-200">
              @for (record of generatedData(); track $index) {
                <tr class="hover:bg-slate-50 transition-colors group">
                  
                  <!-- NAME -->
                  <td 
                    class="sticky left-0 z-10 bg-white group-hover:bg-slate-50 px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900 border-r border-slate-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)] cursor-pointer hover:text-indigo-600 transition-all"
                    (click)="!isCollapsed('fullName') && copyToClipboard(record.fullName, $event)"
                  >
                    @if (isCollapsed('fullName')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.fullName }}
                    }
                  </td>

                  <!-- BANK -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-600 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 active:bg-slate-200 transition-all"
                    (click)="!isCollapsed('bankName') && copyToClipboard(record.bankName, $event)"
                  >
                    @if (isCollapsed('bankName')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.bankName }}
                    }
                  </td>
                  
                  <!-- PRIMARY ID -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-600 font-mono cursor-pointer hover:bg-slate-100 hover:text-indigo-600 active:bg-slate-200 border-b-2 border-dotted border-transparent hover:border-indigo-300 transition-all"
                    (mouseenter)="showTooltip($event, 'primaryIdentifier', record)"
                    (mouseleave)="hideTooltip()"
                    (click)="!isCollapsed('primaryIdentifier') && copyToClipboard(record.primaryIdentifier, $event)"
                  >
                    @if (isCollapsed('primaryIdentifier')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.primaryIdentifier }}
                    }
                  </td>

                  <!-- SECONDARY ID -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-600 font-mono cursor-pointer hover:bg-slate-100 hover:text-indigo-600 active:bg-slate-200 border-b-2 border-dotted border-transparent hover:border-indigo-300 transition-all"
                    (mouseenter)="showTooltip($event, 'secondaryIdentifier', record)"
                    (mouseleave)="hideTooltip()"
                    (click)="!isCollapsed('secondaryIdentifier') && copyToClipboard(record.secondaryIdentifier, $event)"
                  >
                    @if (isCollapsed('secondaryIdentifier')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.secondaryIdentifier }}
                    }
                  </td>

                  <!-- CCY -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-600 cursor-pointer hover:bg-slate-100 transition-all"
                    (click)="!isCollapsed('currency') && copyToClipboard(record.currency, $event)"
                  >
                    @if (isCollapsed('currency')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      <span class="inline-flex items-center rounded bg-slate-100 px-2 py-0.5 text-xs font-medium text-slate-800">
                        {{ record.currency }}
                      </span>
                    }
                  </td>

                  <!-- STREET 1 -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('street1') && copyToClipboard(record.street1, $event)"
                  >
                    @if (isCollapsed('street1')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.street1 }}
                    }
                  </td>

                  <!-- STREET 2 -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('street2') && copyToClipboard(record.street2, $event)"
                  >
                    @if (isCollapsed('street2')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.street2 || '-' }}
                    }
                  </td>

                  <!-- CITY -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('city') && copyToClipboard(record.city, $event)"
                  >
                    @if (isCollapsed('city')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.city }}
                    }
                  </td>

                  <!-- REGION -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('region') && copyToClipboard(record.region, $event)"
                  >
                    @if (isCollapsed('region')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.region }}
                    }
                  </td>

                  <!-- POSTAL -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('postalCode') && copyToClipboard(record.postalCode, $event)"
                  >
                    @if (isCollapsed('postalCode')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.postalCode }}
                    }
                  </td>

                  <!-- COUNTRY CODE -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('countryCode') && copyToClipboard(record.countryCode, $event)"
                  >
                    @if (isCollapsed('countryCode')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.countryCode }}
                    }
                  </td>

                  <!-- COUNTRY NAME -->
                  <td 
                    class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 cursor-pointer hover:bg-slate-100 hover:text-indigo-600 transition-all" 
                    (click)="!isCollapsed('country') && copyToClipboard(record.country, $event)"
                  >
                    @if (isCollapsed('country')) {
                      <div class="text-center text-slate-300 select-none">-</div>
                    } @else {
                      {{ record.country }}
                    }
                  </td>

                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    } @else {
      <div class="h-96 flex flex-col items-center justify-center text-slate-400 border-2 border-dashed border-slate-200 rounded-xl bg-slate-50/50">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-4 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />
        </svg>
        <p class="text-lg font-medium">Ready to generate data</p>
        <p class="text-sm">Select a country and click Generate</p>
      </div>
    }
  </div>
</div>

<!-- Custom Tooltip -->
@if (hoveredField()) {
  <div 
    class="fixed z-50 px-3 py-2 text-sm font-medium text-white bg-slate-900 rounded-lg shadow-lg pointer-events-none max-w-xs transform -translate-y-full mt-[-5px]"
    [style.top.px]="hoveredField()!.y"
    [style.left.px]="hoveredField()!.x"
  >
    {{ hoveredField()!.content }}
  </div>
}

<!-- Copied Toast -->
@if (copiedMessage()) {
  <div 
    class="fixed z-50 px-3 py-1.5 text-xs font-semibold text-green-700 bg-green-100 border border-green-200 rounded shadow-sm pointer-events-none transform -translate-x-1/2 transition-opacity"
    [style.top.px]="copiedMessage()!.y"
    [style.left.px]="copiedMessage()!.x"
  >
    {{ copiedMessage()!.text }}
  </div>
}
